conda activate 3.11.13



# To attach to Chrome DevTools from WSL2, the download feature doesn't work
./test_playwright_attach_to_existing_browser_session.py

    ### do steps below to enable debug Chrome. We don't use 9222 (default) as it seems conflicting with portproxy service
    # open port 9229 
    netsh advfirewall firewall add rule name="Allow Chrome Debug Port 9229" dir=in action=allow protocol=TCP localport=9229
    # set port proxy (otherwise no one can connect to localhost from WSL2)
    netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=9229 connectaddress=127.0.0.1 connectport=9229

    # start chrome in powershell (admin). Note: even though below command set 0.0.0.0, looks like Windows will block the setting of enabling 0.0.0.0 and only allow 127.0.0.1, which will make port proxy necessary (the previous step) 
    & "C:\Program Files\Google\Chrome\Application\chrome.exe" --remote-debugging-address=0.0.0.0 --remote-debugging-port=9229 --user-data-dir="C:\chrome-dev-profile"

    # then to check if this Chrome session is accessible from VSCode on WSL2
    curl http://192.168.1.227:9229/json/version

    # If it still doesn't work, try to stop svchost service (as it occupies 9229 sometimes)
    # Use ' netstat -ano | findstr 9229' to check
    1, Stop-Service iphlpsvc
    2, & "C:\Program Files\Google\Chrome\Application\chrome.exe" --remote-debugging-address=0.0.0.0 --remote-debugging-port=9229 --user-data-dir="C:\chrome-dev-profile"
    3, Start-Service iphlpsvc



# To start CHrome with playwright